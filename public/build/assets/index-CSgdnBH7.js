import{A as l,C as i,b as e,k as v,W as y,m as g}from"./vendor-ui-EoCh-MHn.js";import{R as u,D as $}from"./require-permission-D8-Qn5WK.js";import{T as d,e as p,B as c,A as D,f as m,D as b,g as x,h as z,i as C,j as P,k as T,l as k,m as h,n as f,u as w,o as A}from"./main-Nj9AaWuF.js";import{e as K}from"./external-link-DyOj_YmX.js";import{p as S}from"./pencil-9WHZmswv.js";import{t as V,p as N}from"./trash-2-CfB_nnlj.js";import"./vendor-table-_hmjMY5i.js";import"./table-Dl_ZGIDL.js";import"./chevron-right-BdL49Itd.js";import"./badge-60gDYzWY.js";import"./vendor-form-BYywqLDt.js";import"./vendor-editor-B9FEBeCH.js";var R=l('<a target=_blank rel="noopener noreferrer"class="group inline-flex items-center gap-1 font-medium hover:opacity-70 transition-opacity"><span>'),q=l('<span class="inline-flex items-center px-2 py-0.5 text-xs font-medium rounded-md bg-muted text-foreground/80">'),_=l('<span class="text-sm text-muted-foreground">'),B=l("<span class=text-sm>"),H=l('<div class="flex items-center gap-1">');const j=[{accessorKey:"title",header:"标题",cell:r=>{const t=r.row.original;return(()=>{var a=R(),o=a.firstChild;return i(o,()=>r.getValue()),i(a,e(K,{class:"size-3.5 shrink-0 opacity-0 group-hover:opacity-100 transition-opacity"}),null),v(()=>y(a,"href",t.url)),a})()}},{accessorKey:"category.name",header:"栏目",cell:r=>(()=>{var t=q();return i(t,()=>r.getValue()),t})()},{accessorKey:"views",header:"浏览量",cell:r=>(()=>{var t=_();return i(t,()=>r.getValue()),t})()},{accessorKey:"creator.username",header:"作者",cell:r=>(()=>{var t=B();return i(t,()=>r.getValue()),t})()},{accessorKey:"created_at",header:"创建时间",cell:r=>{const t=new Date(r.getValue());return(()=>{var a=_();return i(a,()=>t.toLocaleDateString("zh-CN")),a})()}},{id:"actions",header:"操作",cell:r=>{const t=r.row.original,a=r.table.options.meta,o=async()=>{try{await f.delete(t.id),a.refetch()}catch(n){console.error("删除失败",n)}};return(()=>{var n=H();return i(n,e(u,{permission:"articles:update_article",get children(){return e(d,{get children(){return[e(p,{as:s=>e(c,g({as:D,get href(){return`/articles/${t.id}`},variant:"ghost",size:"icon-sm"},s,{get children(){return e(S,{class:"size-3.5"})}}))}),e(m,{children:"编辑"})]}})}}),null),i(n,e(u,{permission:"articles:delete_article",get children(){return e(b,{get children(){return[e(d,{get children(){return[e(x,{as:s=>e(p,g({as:c,variant:"ghost",size:"icon-sm",class:"text-destructive hover:text-destructive hover:bg-destructive/10"},s,{get children(){return e(V,{class:"size-3.5"})}}))}),e(m,{children:"删除"})]}}),e(z,{get children(){return[e(C,{get children(){return[e(P,{children:"删除文章"}),e(T,{children:"删除后将无法恢复，确定要删除这篇文章吗？"})]}}),e(k,{get children(){return[e(h,{as:c,variant:"outline",children:"取消"}),e(h,{as:c,variant:"destructive",onClick:o,children:"确认删除"})]}})]}})]}})}}),null),n})()},enableHiding:!1}];var E=l('<div class="rounded-lg border bg-card p-3.5 pb-2">');function Z(){const[r,t]=w(),a=A(),o=()=>({search:typeof r.search=="string"?r.search:void 0,page:Number(r.page)||1,page_size:Number(r.page_size)||10}),n=s=>{t({search:s.search||"",page:String(s.page??1),page_size:String(s.page_size??10)})};return(()=>{var s=E();return i(s,e($,{columns:j,get fetcher(){return f.list},get queryParams(){return o()},onChange:n,searchPlaceholder:"搜索文章标题...",get toolbarActions(){return e(u,{permission:"articles:create_article",get children(){return e(c,{size:"sm",onClick:()=>a("/articles/create"),get children(){return[e(N,{class:"size-4"}),"新建文章"]}})}})}})),s})()}export{Z as default};

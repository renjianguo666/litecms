import{b as a,m as W,z as X,s as Y,h as G,A as u,C as i,Q as ee,S as f,k as y,U as x,F as q,V,e as te,d as B}from"./vendor-ui-EoCh-MHn.js";import{I as re,r as b,s as ne,w as le}from"./main-Nj9AaWuF.js";import{c as se}from"./chevron-right-BdL49Itd.js";var ae=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],oe=w=>a(re,W(w,{iconNode:ae,name:"folder"})),ie=oe,de=u('<div class="mt-1 text-xs text-muted-foreground">已选: <span class="text-primary font-medium">'),ce=u("<div><span class=text-sm>"),ue=u('<div data-slot=tree-list><div class="px-3 py-2 border-b bg-muted/50 shrink-0"><div class="flex items-center justify-between"><span class="text-sm font-medium"></span><button type=button>全部</button></div></div><div class="flex-1 overflow-y-auto py-1 min-h-0">'),he=u('<div class="py-8 text-center text-sm text-muted-foreground">'),fe=u("<button type=button>"),pe=u("<span>"),ge=u('<span class="text-xs text-muted-foreground/60 mr-2">(当前)'),me=u('<div><div class="flex h-full shrink-0"><div class="relative h-full"style=width:18px><div class="absolute top-0"style=left:9px></div><div class=absolute style=left:9px;top:50%;width:9px></div></div></div><span>'),ve=u('<div class="absolute top-0 h-full"style=left:9px>'),xe=u('<div class="relative h-full"style=width:18px>'),be=u('<span class="w-4 shrink-0">');function _e(w,n){const S=()=>n?.(),p=G(()=>{const t=w();return t.map((o,l)=>{const s=t[l+1],c=s?s.depth>o.depth:!1;return{...o,has_children:c}})}),E=()=>new Set(p().filter(t=>t.has_children).map(t=>t.id)),[k,L]=B(E()),[I,N]=B(!0),D=()=>{I()?(L(new Set),N(!1)):(L(E()),N(!0))},P=(t,o)=>{o.stopPropagation();const l=new Set(k());l.has(t)?l.delete(t):l.add(t),L(l)},T=t=>{const o=p(),l=o[t];if(l.depth===0)return!0;let s=l.depth-1;for(let c=t-1;c>=0&&s>=0;c--){const e=o[c];if(e.depth===s){if(!k().has(e.id))return!1;s--}}return!0},z=(t,o)=>{const l=p();for(let s=t+1;s<l.length;s++){if(l[s].depth===o)return!1;if(l[s].depth<o)return!0}return!0};return{processedNodes:p,expanded:k,allExpanded:I,toggleAll:D,toggleExpand:P,isVisible:T,isLastInLevel:z,getTreeLines:t=>{const o=p(),l=o[t],s=[];for(let c=0;c<l.depth;c++){let e=-1;for(let d=t-1;d>=0;d--)if(o[d].depth===c){e=d;break}if(e===-1){s.push(!1);continue}s.push(!z(e,c))}return s},isDisabled:t=>t===S()}}function ke(w){const[n]=Y(w,["nodes","value","onChange","class","title","placeholder","disabledId","allowEmpty","emptyLabel","showIcon"]),{processedNodes:S,expanded:p,allExpanded:E,toggleAll:k,toggleExpand:L,isVisible:I,isLastInLevel:N,getTreeLines:D,isDisabled:P}=_e(()=>n.nodes,()=>n.disabledId),T=g=>{n.onChange(g)},z=G(()=>n.value===null||n.value===""?n.emptyLabel??"无":n.nodes.find(_=>_.id===n.value)?.name??"");return(()=>{var g=ue(),_=g.firstChild,t=_.firstChild,o=t.firstChild,l=o.nextSibling,s=l.firstChild,c=_.nextSibling;return i(o,()=>n.title??"选择节点"),ee(l,"click",k,!0),i(l,()=>E()?"收起":"展开",s),i(_,a(f,{get when(){return n.value!==void 0},get children(){var e=de(),d=e.firstChild,h=d.nextSibling;return i(h,z),e}}),null),i(c,a(f,{get when(){return n.allowEmpty!==!1},get children(){var e=ce(),d=e.firstChild;return e.$$click=()=>T(null),i(d,()=>n.emptyLabel??"作为顶级"),y(()=>x(e,b("flex items-center h-7 px-2 mx-1 cursor-pointer select-none rounded-sm","transition-colors duration-150",n.value===null||n.value===""?"bg-primary text-primary-foreground":"hover:bg-accent hover:text-accent-foreground"))),e}}),null),i(c,a(f,{get when(){return S().length>0},get fallback(){return(()=>{var e=he();return i(e,()=>n.placeholder??"暂无数据"),e})()},get children(){return a(q,{get each(){return S()},children:(e,d)=>{const h=()=>P(e.id),$=()=>n.value===e.id,J=()=>N(d(),e.depth),K=()=>D(d()),Q=()=>p().has(e.id),F=()=>$()?"1px solid hsl(var(--primary-foreground) / 0.6)":"1px solid hsl(var(--muted-foreground) / 0.3)";return a(f,{get when(){return I(d())},get children(){var m=me(),j=m.firstChild,R=j.firstChild,M=R.firstChild,O=M.nextSibling,A=j.nextSibling;return m.$$click=()=>!h()&&T(e.id),i(j,a(q,{get each(){return K()},children:r=>(()=>{var v=xe();return i(v,a(f,{when:r,get children(){var C=ve();return y(H=>V(C,"border-left",F())),C}})),v})()}),R),i(m,a(f,{get when(){return e.has_children},get fallback(){return be()},get children(){var r=fe();return r.$$click=v=>L(e.id,v),i(r,a(f,{get when(){return Q()},get fallback(){return a(se,{class:"size-3.5"})},get children(){return a(ne,{class:"size-3.5"})}})),y(()=>x(r,b("w-4 h-4 flex items-center justify-center shrink-0 rounded","transition-transform duration-200",$()?"text-primary-foreground/80 hover:text-primary-foreground":"text-muted-foreground hover:text-foreground"))),r}}),A),i(m,a(f,{get when(){return n.showIcon!==!1},get children(){var r=pe();return i(r,a(f,{get when(){return te(()=>!!e.has_children)()&&Q()},get fallback(){return a(ie,{class:"size-4"})},get children(){return a(le,{class:"size-4"})}})),y(()=>x(r,b("ml-0.5 shrink-0",$()?"text-primary-foreground/80":"text-amber-500 dark:text-amber-400"))),r}}),A),i(A,()=>e.name),i(m,a(f,{get when(){return h()},get children(){return ge()}}),null),y(r=>{var v=b("group flex items-center h-7 mx-1 select-none rounded-sm","transition-colors duration-150",h()&&"opacity-50 cursor-not-allowed",!h()&&$()&&"bg-primary text-primary-foreground cursor-pointer",!h()&&!$()&&"hover:bg-accent hover:text-accent-foreground cursor-pointer"),C=J()?"50%":"100%",H=F(),U=F(),Z=b("text-sm ml-1.5 truncate pr-2",$()&&"font-medium");return v!==r.e&&x(m,r.e=v),C!==r.t&&V(M,"height",r.t=C),H!==r.a&&V(M,"border-left",r.a=H),U!==r.o&&V(O,"border-top",r.o=U),Z!==r.i&&x(A,r.i=Z),r},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),m}})}})}}),null),y(e=>{var d=b("flex flex-col rounded-lg border bg-card text-card-foreground overflow-hidden",n.class),h=b("inline-flex items-center gap-1 px-1.5 py-0.5 text-xs rounded","text-muted-foreground","hover:bg-accent hover:text-accent-foreground","transition-colors");return d!==e.e&&x(g,e.e=d),h!==e.t&&x(l,e.t=h),e},{e:void 0,t:void 0}),g})()}X(["click"]);export{ke as T,ie as f};

import{A as l,C as n,U as d,b as e,m as g}from"./vendor-ui-EoCh-MHn.js";import{R as u,D as x}from"./require-permission-pgA8frjK.js";import{T as m,e as p,B as o,A as $,f as h,D as y,g as b,h as D,i as z,j as C,k as P,l as T,m as f,a0 as v,u as S,o as K}from"./main-8-Lyl6Ls.js";import{p as N}from"./pencil-BMlSz4kK.js";import{t as V,p as w}from"./trash-2-DFLhenRk.js";import"./vendor-table-_hmjMY5i.js";import"./table-BEZ5gYHa.js";import"./chevron-right-DrHrtMe-.js";import"./badge-CMo7waT2.js";import"./vendor-form-BYywqLDt.js";import"./vendor-editor-B9FEBeCH.js";var A=l("<span class=font-medium>"),k=l("<span class=text-sm>"),q=l('<span class="text-sm text-muted-foreground">-'),_=l("<span>"),B=l('<span class="text-sm text-muted-foreground">'),H=l('<div class="flex items-center gap-1">');const R=[{accessorKey:"username",header:"用户名",cell:t=>(()=>{var r=A();return n(r,()=>t.getValue()),r})()},{accessorKey:"email",header:"邮箱",cell:t=>{const r=t.getValue();return r?(()=>{var a=k();return n(a,r),a})():q()}},{accessorKey:"is_active",header:"状态",cell:t=>{const r=t.getValue();return(()=>{var a=_();return d(a,`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${r?"bg-primary/10 text-primary":"bg-muted text-muted-foreground"}`),n(a,r?"启用":"禁用"),a})()}},{accessorKey:"is_superuser",header:"超级管理员",cell:t=>{const r=t.getValue();return(()=>{var a=_();return d(a,`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${r?"bg-secondary text-secondary-foreground":"bg-muted text-muted-foreground"}`),n(a,r?"是":"否"),a})()}},{accessorKey:"created_at",header:"创建时间",cell:t=>{const r=new Date(t.getValue());return(()=>{var a=B();return n(a,()=>r.toLocaleDateString("zh-CN")),a})()}},{id:"actions",header:"操作",cell:t=>{const r=t.row.original,a=t.table.options.meta,c=async()=>{try{await v.delete(r.id),a.refetch()}catch(i){console.error("删除失败",i)}};return(()=>{var i=H();return n(i,e(u,{permission:"accounts:update_user",get children(){return e(m,{get children(){return[e(p,{as:s=>e(o,g({as:$,get href(){return`/users/${r.id}`},variant:"ghost",size:"icon-sm"},s,{get children(){return e(N,{class:"size-3.5"})}}))}),e(h,{children:"编辑"})]}})}}),null),n(i,e(u,{permission:"accounts:delete_user",get children(){return e(y,{get children(){return[e(m,{get children(){return[e(b,{as:s=>e(p,g({as:o,variant:"ghost",size:"icon-sm",class:"text-destructive hover:text-destructive hover:bg-destructive/10"},s,{get children(){return e(V,{class:"size-3.5"})}}))}),e(h,{children:"删除"})]}}),e(D,{get children(){return[e(z,{get children(){return[e(C,{children:"删除用户"}),e(P,{children:"删除后将无法恢复，确定要删除该用户吗？"})]}}),e(T,{get children(){return[e(f,{as:o,variant:"outline",children:"取消"}),e(f,{as:o,variant:"destructive",onClick:c,children:"确认删除"})]}})]}})]}})}}),null),i})()},enableHiding:!1}];var U=l('<div class="rounded-lg border bg-card p-3.5 pb-2">');function X(){const[t,r]=S(),a=K(),c=()=>({search:typeof t.search=="string"?t.search:void 0,page:Number(t.page)||1,page_size:Number(t.page_size)||10}),i=s=>{r({search:s.search||"",page:String(s.page??1),page_size:String(s.page_size??10)})};return(()=>{var s=U();return n(s,e(x,{columns:R,get fetcher(){return v.list},get queryParams(){return c()},onChange:i,searchPlaceholder:"搜索用户...",get toolbarActions(){return e(u,{permission:"accounts:create_user",get children(){return e(o,{size:"sm",onClick:()=>a("/users/create"),get children(){return[e(w,{class:"size-4"}),"添加用户"]}})}})}})),s})()}export{X as default};

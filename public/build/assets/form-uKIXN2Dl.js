import{a0 as _,h as N,b as e,A as u,C as t,S as L,k as O,U as R,e as I}from"./vendor-ui-EoCh-MHn.js";import{K as M,x as U,L as j,M as B,N as V,H as q,q as A}from"./main-B6UhN7Jf.js";import{T as E}from"./tree-list-CrSDMdRM.js";import{r as H}from"./rotate-ccw-2iP1iOhh.js";import{s as K}from"./save-DLjXE32a.js";var W=u("<aside>"),D=u('<div class="lg:ml-65 space-y-4"><div class=lg:hidden><div class="bg-card rounded-lg border border-border shadow-sm"><div class=p-5><h2 class="text-base font-semibold mb-4">父级栏目</h2></div></div></div><div class="bg-card rounded-lg border border-border shadow-sm"><div class=p-5><h2 class="text-base font-semibold mb-4">基本信息</h2><div class="grid grid-cols-1 gap-4"></div></div></div><div class="bg-card rounded-lg border border-border shadow-sm"><div class=p-5><h2 class="text-base font-semibold mb-4">高级设置</h2><div class="grid grid-cols-1 gap-4"></div></div></div><div class="bg-card rounded-lg border border-border shadow-sm"><div class=p-5><h2 class="text-base font-semibold mb-4">显示设置</h2><div class="grid grid-cols-1 md:grid-cols-2 gap-4"></div></div></div><div class="flex justify-end gap-3 pt-2">'),G=u('<div class="h-full border border-border rounded-lg bg-card flex items-center justify-center">');function Z(d){const{isOpen:S}=M(),[o]=_(async()=>(await U.list({page_size:100})).items??[]),[y]=_(()=>j.options()),$=()=>(y()??[]).map(l=>({label:l,value:l})),b=d.mode==="create"?B:V,a=q(()=>({defaultValues:d.defaultValues,validators:{onMount:b,onChange:b},onSubmit:async({value:l})=>{d.mode==="create"?await d.onSubmit(l):await d.onSubmit(l)}})),x=N(()=>{const l=o()??[];if(l.length===0)return[];const i=new Set(l.map(r=>r.parent_id).filter(r=>r!=null));return l.map(r=>({id:r.id,name:r.name,parent_id:r.parent_id??null,depth:r.depth,has_children:i.has(r.id)}))});return e(a.Form,{class:"relative",get children(){return[(()=>{var l=W();return t(l,e(L,{get when(){return!o.loading},get fallback(){return(()=>{var i=G();return t(i,e(A,{class:"size-6 animate-spin text-muted-foreground"})),i})()},get children(){return e(a.Field,{name:"parent_id",children:i=>e(E,{get nodes(){return x()},get value(){return i().state.value},onChange:r=>i().handleChange(r),title:"选择父级栏目",emptyLabel:"顶级栏目",get disabledId(){return d.disabledId},class:"h-full shadow-sm"})})}})),O(()=>R(l,`hidden lg:block fixed top-20 bottom-4 w-60 transition-[left] duration-300 ${S()?"left-58":"left-20"}`)),l})(),(()=>{var l=D(),i=l.firstChild,r=i.firstChild,g=r.firstChild;g.firstChild;var h=i.nextSibling,C=h.firstChild,F=C.firstChild,s=F.nextSibling,p=h.nextSibling,w=p.firstChild,k=w.firstChild,c=k.nextSibling,f=p.nextSibling,T=f.firstChild,z=T.firstChild,m=z.nextSibling,v=f.nextSibling;return t(g,e(a.SelectField,{name:"parent_id",label:"选择父级栏目",placeholder:"作为顶级栏目",get options(){return(o()??[]).map(n=>({label:(n.depth>0?"　".repeat(n.depth)+"› ":"")+n.name,value:n.id}))},nullable:!0}),null),t(s,e(a.StringField,{name:"name",label:"名称",placeholder:"请输入分类名称"}),null),t(s,e(a.StringField,{name:"title",label:"标题",placeholder:"请输入分类标题（可选）"}),null),t(s,e(a.TextareaField,{name:"description",label:"描述",placeholder:"请输入分类描述...",rows:3}),null),t(s,e(a.StringField,{name:"cover_url",label:"封面图片",placeholder:"请输入封面图片URL"}),null),t(c,e(a.StringField,{name:"path",label:"栏目路径",placeholder:"如：/category/{key}",description:"可用占位符{key}{year}{month}{day}{y}{m}{d}{parent}"}),null),t(c,e(a.StringField,{name:"content_path",label:"内容路径",placeholder:"如：/p/{key}.html",description:"可用占位符{key}{year}{month}{day}{y}{m}{d}{parent}"}),null),t(c,e(a.StringField,{name:"domain",label:"域名",description:"绑定域名"}),null),t(m,e(a.NumberField,{name:"page_size",label:"每页条数",placeholder:"默认10条",min:1,max:100}),null),t(m,e(a.NumberField,{name:"priority",label:"优先级",placeholder:"数值越大越靠前",min:0}),null),t(m,e(a.SelectField,{name:"template",label:"模板",placeholder:"请选择模板",get options(){return $()},nullable:!1}),null),t(v,e(a.ResetButton,{class:"gap-2",get children(){return[e(H,{class:"size-4"}),"重置"]}}),null),t(v,e(a.SubmitButton,{class:"gap-2",get children(){return[e(K,{class:"size-4"}),I(()=>d.submitText??"保存")]}}),null),l})()]}})}export{Z as C};

import{b as e,A as c,C as n,e as $,k as f,V as D,W as b,m as _}from"./vendor-ui-EoCh-MHn.js";import{R as m,D as C}from"./require-permission-D8-Qn5WK.js";import{e as u,t as z,f as d,T as p,B as l,A as P,D as T,g as k,h as w,i as S,j as V,k as K,l as A,m as v,x as y,u as N,o as R}from"./main-Nj9AaWuF.js";import{c as q}from"./chevron-right-BdL49Itd.js";import{e as B}from"./external-link-DyOj_YmX.js";import{p as H}from"./pencil-9WHZmswv.js";import{t as j,p as E}from"./trash-2-CfB_nnlj.js";import"./vendor-table-_hmjMY5i.js";import"./table-Dl_ZGIDL.js";import"./badge-60gDYzWY.js";import"./vendor-form-BYywqLDt.js";import"./vendor-editor-B9FEBeCH.js";var F=c('<span class="font-medium flex items-center"><a target=_blank rel="noopener noreferrer"class="group inline-flex items-center gap-1 hover:opacity-70 transition-opacity"><span>'),I=c('<span class="inline-flex items-center text-muted-foreground/60">'),h=c('<span class="text-sm text-muted-foreground">'),L=c('<div class="flex items-center gap-1">');const Q=[{accessorKey:"id",header:"ID",cell:t=>{const r=t.getValue();return e(p,{get children(){return[e(u,{as:"button",class:"font-mono text-xs text-muted-foreground hover:text-foreground cursor-pointer",onClick:()=>{navigator.clipboard.writeText(r),z.success(r,"复制成功")},get children(){return r.slice(-8)}}),e(d,{children:r})]}})}},{accessorKey:"name",header:"名称",cell:t=>{const r=t.row.original,i=t.getValue();return(()=>{var o=F(),a=o.firstChild,s=a.firstChild;return n(o,(()=>{var x=$(()=>r.depth>0);return()=>x()&&(()=>{var g=I();return n(g,e(q,{class:"size-4"})),f(J=>D(g,"padding-left",`${r.depth*1.5}rem`)),g})()})(),a),n(s,i),n(a,e(B,{class:"size-3.5 shrink-0 opacity-0 group-hover:opacity-100 transition-opacity"}),null),f(()=>b(a,"href",r.url)),o})()}},{accessorKey:"priority",header:"优先级",cell:t=>(()=>{var r=h();return n(r,()=>t.getValue()),r})()},{accessorKey:"page_size",header:"每页条数",cell:t=>(()=>{var r=h();return n(r,()=>t.getValue()),r})()},{accessorKey:"created_at",header:"创建时间",cell:t=>{const r=new Date(t.getValue());return(()=>{var i=h();return n(i,()=>r.toLocaleDateString("zh-CN")),i})()}},{id:"actions",header:"操作",cell:t=>{const r=t.row.original,i=t.table.options.meta,o=async()=>{try{await y.delete(r.id),i.refetch()}catch(a){console.error("删除失败",a)}};return(()=>{var a=L();return n(a,e(m,{permission:"taxonomies:update_category",get children(){return e(p,{get children(){return[e(u,{as:s=>e(l,_({as:P,get href(){return`/categories/${r.id}`},variant:"ghost",size:"icon-sm"},s,{get children(){return e(H,{class:"size-3.5"})}}))}),e(d,{children:"编辑"})]}})}}),null),n(a,e(m,{permission:"taxonomies:delete_category",get children(){return e(T,{get children(){return[e(p,{get children(){return[e(k,{as:s=>e(u,_({as:l,variant:"ghost",size:"icon-sm",class:"text-destructive hover:text-destructive hover:bg-destructive/10"},s,{get children(){return e(j,{class:"size-3.5"})}}))}),e(d,{children:"删除"})]}}),e(w,{get children(){return[e(S,{get children(){return[e(V,{children:"删除分类"}),e(K,{children:"删除后将无法恢复，确定要删除该分类吗？"})]}}),e(A,{get children(){return[e(v,{as:l,variant:"outline",children:"取消"}),e(v,{as:l,variant:"destructive",onClick:o,children:"确认删除"})]}})]}})]}})}}),null),a})()},enableHiding:!1}],W=[];var G=c('<div class="rounded-lg border bg-card p-3.5 pb-2">');function ie(){const[t,r]=N(),i=R(),o=()=>({search:typeof t.search=="string"?t.search:void 0,page:Number(t.page)||1,page_size:Number(t.page_size)||10}),a=s=>{r({search:s.search||"",page:String(s.page??1),page_size:String(s.page_size??10)})};return(()=>{var s=G();return n(s,e(C,{columns:Q,get fetcher(){return y.list},get queryParams(){return o()},onChange:a,filterConfig:W,searchPlaceholder:"搜索分类...",get toolbarActions(){return e(m,{permission:"taxonomies:create_category",get children(){return e(l,{size:"sm",onClick:()=>i("/categories/create"),get children(){return[e(E,{class:"size-4"}),"添加分类"]}})}})}})),s})()}export{ie as default};
